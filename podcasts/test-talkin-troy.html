<head>
    <meta charset="UTF-8">
    <meta name="description" content="Daily Trojan">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Podcast Test - Daily Trojan</title>

    <link rel="stylesheet" href="../univ-stylesheet.css">
    <style>
        h1 {
            font-family: 'Neue Haas Grotesk Text Pro Bold'; 
            font-weight: normal; 
            font-size: 40px;
        }
        h2 { 
            font-family: 'Neue Haas Grotesk Text Pro Bold'; 
            font-weight: normal; 
        }

        p {
            font-family: 'Neue Haas Grotesk Text Pro'; 
            font-size: 17px;
        }

        small {
            font-family: 'Neue Haas Grotesk Text Pro'; 
            color: grey;
            font-size: 14px;
        }

        body { background: black; color: white; }

        #canvas {
            position: fixed;
            left: 0;
            top: 0;
            z-index: -5;
            width: 100%;
            height: 90%;
            border-bottom: 1px solid white;
            opacity: 80%;
        }

        audio {
            position: fixed;
            left: 10px;
            bottom: 10px;
            width: calc(100% - 20px);
        }

        .row { display: flex; margin: 0 auto; }
        .column { margin: 0 5% 0 0; }

        #description { padding: 20px; }

        #transcript { height: 300px; overflow-y: scroll; }
        #transcript p { font-size: 14px; color: grey; }

        @media screen and (max-width: 800px) {
            #description {
                width: 90%; padding: 0;
            }
            #canvas { opacity: 50%; border-bottom: 0; }
            .row { flex-direction: column; }
            .column { margin: 0; padding: 20px; }
        }
    </style>
</head>
<body>
    <div id="content">
        
        <div class="row">
            <div class="column" style="flex: 50%;" id="description">
                <img src="http://dailytrojan.com/wp-content/uploads/2023/05/dailytrojanonline-icon.png" style="width:130px">
                <h1>Talkin&rsquo; Troy</h1>
                <h2>Rivalry Week Recap</h2>
                <small>April 28, 2023</small>
                <p>The Talkin’ Troy team looks at the recent matchups between the Trojans and their rival UCLA Bruins across multiple sports. Hosts Stefano Fendrich and Darren Parry also look at the postseason outlooks for USC baseball, men’s tennis, women’s tennis, women’s water polo and beach volleyball.</p>
                <p>Hosted by Stefano Fendrich and Darren Parry. Written by Leila MacKenzie, Kyle Frankel, Darren Parry, Justin White and Thomas Johnson edited by Thomas Johnson. Produced by Grace Ingram. Talkin’ Troy is one of three shows on the Daily Trojan podcast network. You can find more episodes anywhere you listen to podcasts, as well as our website, dailytrojan.com.</p>
            </div>
            <div class="column" style="flex: 17%;"></div>
            <div class="column" style="flex: 33%;" id="transcript-col">
            </div>
        </div>
        <canvas id="canvas"></canvas>
        <audio oncontextmenu="return false;" id="audio" controls controlsList="nodownload">
            <track label="English" kind="subtitles" srclang="en" src="GE 5_otter_ai.vtt" default>
        </audio>
      </div>
</body>
<script>
    window.onload = function() {

        var audio = document.getElementById("audio");
  
        var files = this.files;
        audio.src = "talkin-troy-4-27.mp3";
        audio.load();
        audio.play();
        var context = new AudioContext();
        var src = context.createMediaElementSource(audio);
        var analyser = context.createAnalyser();

        var canvas = document.getElementById("canvas");
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        var ctx = canvas.getContext("2d");

        src.connect(analyser);
        analyser.connect(context.destination);

        analyser.fftSize = 256;

        var bufferLength = analyser.frequencyBinCount;
        console.log(bufferLength);

        var dataArray = new Uint8Array(bufferLength);

        var WIDTH = canvas.width;
        var HEIGHT = canvas.height;

        var barWidth = (WIDTH / bufferLength) * 2.5;
        var barHeight;
        var x = 0;

        function renderFrame() {
        requestAnimationFrame(renderFrame);

        x = 0;

        analyser.getByteFrequencyData(dataArray);

        ctx.fillStyle = "#000";
        ctx.fillRect(0, 0, WIDTH, HEIGHT);

        for (var i = 0; i < bufferLength; i++) {
            barHeight = dataArray[i];
            
            var r = barHeight + (25 * (i/bufferLength));
            var g = 250 * (i/bufferLength);
            var b = 50;

            ctx.fillStyle = "rgb(" + r + "," + g + "," + b + ")";
            ctx.fillRect(x, HEIGHT - barHeight, barWidth, barHeight);

            x += barWidth + 1;
        }
        }

        audio.play();
        renderFrame();
    };
</script>